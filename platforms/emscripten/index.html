<!doctype html>
<html lang="en-us">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta charset="utf-8">
    <title>MemoryLeak</title>
    <style>
      canvas { padding-left: 0; padding-right: 0; margin-left: auto; margin-right: auto; display: block; }
    </style>
  </head>
  <body>
    <canvas id="canvas"></canvas>
    <script>
      var Module = {
        print: (function() {
          return function(text) {
            console.log(text);
          };
        })(),
        canvas: document.getElementById('canvas'),
        setStatus: function(text) {
          console.log(text);
        },
        totalDependencies: 0,
        monitorRunDependencies: function(left) {
          this.totalDependencies = Math.max(this.totalDependencies, left);
          Module.setStatus(left ? 'Downloading: ' + (this.totalDependencies-left) + '/' + this.totalDependencies : 'All downloads complete.');
        },
        preRun: function() {
          var assets = FS.createFolder('/', 'assets', true, false);
          var sounds = FS.createFolder(assets, 'sounds', true, false);
          var textures = FS.createFolder(assets, 'textures', true, false);
          var levels = FS.createFolder(assets, 'levels', true, false);
          FS.createDataFile(sounds, '0.wav', "wtf", true, false);
          FS.createDataFile(sounds, '1.wav', "wtf", true, false);
          FS.createDataFile(textures, '0.png', "wtf", true, false);
          FS.createDataFile(levels, '0.wav', "", true, false);
          FS.createDataFile(levels, '1.wav', "", true, false);
          FS.createDataFile(levels, '2.wav', "", true, false);
          FS.createDataFile(levels, '3.wav', "", true, false);
          function handleTextureLoaded(image) {  
            var textures;
            _glGenTextures(1, textures);
            texture = GL.textures[1];
            Module.ctx.bindTexture(Module.ctx.TEXTURE_2D, texture);  
            Module.ctx.texImage2D(Module.ctx.TEXTURE_2D, 0, Module.ctx.RGBA, Module.ctx.RGBA, Module.ctx.UNSIGNED_BYTE, image);  
            Module.ctx.texParameteri(Module.ctx.TEXTURE_2D, Module.ctx.TEXTURE_MAG_FILTER, Module.ctx.NEAREST);  
            Module.ctx.texParameteri(Module.ctx.TEXTURE_2D, Module.ctx.TEXTURE_MIN_FILTER, Module.ctx.NEAREST);  
            Module.ctx.generateMipmap(Module.ctx.TEXTURE_2D);  
          }
          image_element = new Image();  
          image_element.onload = function() { handleTextureLoaded(image_element); }  
          image_element.src = "assets/textures/0.png";  
        }
      };
    </script>
    <script src="raptor_island.js"></script>
  </body>
</html>
