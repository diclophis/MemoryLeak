<!doctype html>
<html>
  <head>
    <script type="text/javascript" charset="utf-8" src="iscroll.js"></script>
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <style>
      * {
        margin: 0;
        padding: 0;
        -webkit-transition-duration: 0.66s;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -webkit-tap-highlight-color: transparent;
      }

      div {
        display: -webkit-box;
        text-align: center;
      }

      body, html {
        width: 100%;
        height: 100%;
      }

      .invisible {
        z-index: -1;
      }

      .visible {
        z-index: 1;
      }

      .transparent {
        background-color: rgba(0, 0, 0, 0);
      }

      .translucent {
        background-color: rgba(0, 0, 0, 0.5);
      }

      #overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        overflow: hidden;
      }

      #inventory {
        width: 100%;
        height: 10%;
        background-color: cyan;
        -webkit-backface-visibility: hidden;
      }

      #inventory.invisible {
        opacity: 0;
      }

      #inventory.visible {
        opacity: 1;
      }

      #main-menu {
        position: absolute;
        top: 10%;
        left: 0;
        width: 100%;
        height: 90%;
        -webkit-box-orient: vertical;
        -webkit-box-align: center;
        -webkit-box-pack: center;
        -webkit-backface-visibility: hidden;
      }

      #main-menu.invisible {
        opacity: 0;
      }

      #main-menu.visible {
        opacity: 1;
      }

      #main-menu div {
        width: 75%;
      }

      #shop {
        color: orange;
        background-color: grey;
        position: absolute;
        top: 10%;
        left: 0;
        width: 100%;
        height: 90%;
        -webkit-box-orient: vertical;
        -webkit-box-align: center;
        -webkit-box-pack: center;
        -webkit-backface-visibility: hidden;
      }

      #shop.invisible {
        opacity: 0;
      }

      #shop.visible {
        opacity: 1;
      }
        
        
      #customization-screen.invisible {
        opacity: 0;
      }
        
      #customization-screen.visible {
        opacity: 1;
      }

      #shop div {
        -webkit-box-align: center;
        -webkit-box-pack: center;
        -webkit-box-orient: vertical;
      }

      #shop div#back-to-main-from-shop-button {
        background-color: yellow;
        width: 25%;
        height: 10%;
        position: absolute;
        top: 0;
        right: 0;
      }

      #title {
        color: white;
        -webkit-box-align: center;
        -webkit-box-pack: center;
        background-color: red;
      }

      #flavor {
        -webkit-box-align: center;
        -webkit-box-pack: center;
        background-color: blue;
        color: white;
      }

      .visible #flavor {
      }

      #start-button {
        height: 20%;
        color: green;
        -webkit-box-align: center;
        -webkit-box-pack: center;
        background-color: yellow;
      }

      .visible #start-button {
        -webkit-transform: translate3d(0%, 0, 0);
      }

      .invisible #start-button {
        -webkit-transform: translate3d(500%, 0, 0);
      }

      #shop-button {
        height: 20%;
        color: blue;
        text-align: center;
        -webkit-box-align: center;
        -webkit-box-pack: center;
        background-color: purple;
      }

      .visible #shop-button {
        -webkit-transform: translate3d(0%, 0, 0);
      }

      .invisible #shop-button {
        -webkit-transform: translate3d(-500%, 0, 0);
      }

      #hud {
        color: red;
        background-color: green;
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 5%;
      }
        
      #shop-button {
        height: 20%;
        color: blue;
        text-align: center;
        -webkit-box-align: center;
        -webkit-box-pack: center;
        background-color: purple;
        -webkit-transition-delay: 2s;
      }
        #customization-screen {
            height: 100%;
            width:100%;
            color: blue;
            text-align: center;
            -webkit-box-align: center;
            -webkit-box-pack: center;
            background-color: red;
            //-webkit-transition-delay: 2s;
        }
        #weaponTitle {
            position:absolute;
            height: 3%%;
            left:5%;
            width:20%;
            color: blue;
            text-align: center;
            top:8%;
            background-color: green;
        }
        #weapon_lv1 {
            position:absolute;
            height: 8%;
            width:20%;
            left:5%;
            color: blue;
            text-align: center;
            top:10%;
            background-color: purple;
        }
        #weapon_lv2 {
            position:absolute;
            height: 8%;
            width:20%;
            left:25%;
            color: blue;
            text-align: center;
            top:10%;
            background-color: purple;
        }
        #weapon_lv3 {
            position:absolute;
            height: 8%;
            width:20%;
            left:45.2%;
            color: blue;
            text-align: center;
            top:10%;
            background-color: purple;
        }
        #weapon_confirm {
            position:absolute;
            height: 8%;
            width:20%;
            left:70.2%;
            color: blue;
            text-align: center;
            top:10%;
            background-color: purple;
        }
        #weapon_descr {
            position:absolute;
            height: 8%;
            width:85%;
            left:5%;
            color: blue;
            text-align: center;
            top:22%;
            background-color: green;
        }
        
        #backToMainMenu {
            height: 10%;
            position:absolute;
            text-align: center;
            background-color: blue;
            width:25%;
            left:25%;
            height:5%;
            top:80%;
            color:red;
        }

        #armor_title {
            position:absolute;
            height: 3%%;
            left:5%;
            width:20%;
            color: blue;
            text-align: center;
            top:42%;
            background-color: green;
        }
        #armor_lv1 {
            position:absolute;
            height: 8%;
            width:20%;
            left:5%;
            color: blue;
            text-align: center;
            top:45%;
            background-color: purple;
        }
        #armor_lv2 {
            position:absolute;
            height: 8%;
            width:20%;
            left:25%;
            color: blue;
            text-align: center;
            top:45%;
            background-color: purple;
        }
        #armor_lv3 {
            position:absolute;
            height: 8%;
            width:20%;
            left:45.2%;
            color: blue;
            text-align: center;
            top:45%;
            background-color: purple;
        }
        #armor_confirm {
            position:absolute;
            height: 8%;
            width:20%;
            left:70.2%;
            color: blue;
            text-align: center;
            top:45%;
            background-color: purple;
        }
        #armor_descr {
            position:absolute;
            height: 8%;
            width:85%;
            left:5%;
            color: blue;
            text-align: center;
            top:57%;
            background-color: green;
        }
        #Fight{
            height: 10%;
            position:absolute;
            text-align: center;
            background-color: green;
            width:25%;
            left:55%;
            height:5%;
            top:80%;
        }

      #hud div {
      }

      #hud.invisible {
        opacity: 0;
      }

      #hud.visible {
        opacity: 1;
      }

      #player-health-container {
        width: 50%;
        height: 100%;
        overflow: hidden;
      }

      #player-health-bar {
        width: 100%;
        background-color: purple;
        -webkit-transition-property: none;
      }

      #enemy-health-container {
        width: 50%;
        height: 100%;
        background-color: green;
        overflow: hidden;
      }

      #enemy-health-bar {
        width: 100%;
        background-color: yellow;
        -webkit-transition-property: none;
      }

    </style>
  </head>
  <body class="translucent">
    <div id="overlay" class="transparent">
      <div id="hud" class="invisible">
        <div id="player-health-container">
          <div id="player-health-bar">
            <span id="player-health"></span>
          </div>
        </div>
        <div id="enemy-health-container">
          <div id="enemy-health-bar">
            <span id="enemy-health"></span>
          </div>
        </div>
      </div>
      <div id="shop" class="invisible">
        <div id="back-to-main-from-shop-button">
        </div>
        <div id="shop-weapons">
          <h1>
            weapons
          </h1>
          <div id="weapons_curr_lvl">
            current level
          </div>
          <div id="weapons_upgrade">
            upgrade
          </div>
        </div>
        <div id="shop-armor">
          <h1>
            armor
          </h1>
          <div id="armor_curr_lvl">
            current level
          </div>
          <div id="armor_upgrade">
            upgrade
          </div>
        </div>
        <div id="shop-shields">
          <h1>
            shields
          </h1>
          <div id="shields_curr_lvl">
            current level
          </div>
          <div id="shields_upgrade">
            upgrade
          </div>
        </div>
        <div id="shop-drive">
          <h1>
            hero drive
          </h1>
          <div id="hero_drive_curr_lvl">
            current level
          </div>
          <div id="hero_drive_upgrade">
            upgrade
          </div>
        </div>
      </div>
      <div id="inventory" class="invisible">
        <span id="pennies">
        </span>
        <span id="fuel">
        </span>
      </div>
      <div id="main-menu" class="invisible">
        <div id="title">
          <h1>
            Metal Wolf
          </h1>
        </div>
        <div id="flavor">
          It started with an Eclipse.  The light from the sun was blocked by a massive object of unknown origin.  Strange.  Even more strangely, it was coming closer.  We discovered it to be a ship,  the size of a small planet.  Without warning, without provocation, it began firing on us, reducing our largest cities to ash.  Their technology is hundreds of years ahead of ours.  We are completely outgunned.  The only hope of survival we have, is each other.
        </div>
        <div id="start-button">start</div>
        <div id="shop-button">shop</div>
      </div>
        <div id="customization-screen" class="invisible"> 
            
            <div id="backToMainMenu">Main Menu</div>
            <div id="main-menu-hud">999.999 pennies   0/20 Fuel</div>
            <div id="weaponTitle">Weapons</div>
            
            <div id="weapon_lv1" level="1">Guns</div>
            <div id="weapon_lv2" level="0">Lasers</div>
            <div id="weapon_lv3" level="2">Missiles</div>
            
            <div id="weapon_confirm">OK!</div>
            
            <div id="weapon_descr">Lorem Ipsum</div>
            
            <div id="armor_title">Armor</div>
            <div id="armor_lv1" level="0">Lvl 1</div>
            <div id="armor_lv2" level="1">Lvl 2</div>
            <div id="armor_lv3" level="2">Lvl 3</div>
            
            <div id="armor_confirm">OK!</div>
            
            <div id="armor_descr">Lorem Ipsum</div>
            
            
            <div id="Fight">Fight!</div>
        </div>
    </div>
      
      
      
    <script>
      try {

        var startButton = document.getElementById("start-button");
        var shopButton = document.getElementById("shop-button");
        var backToMainFromShopButton = document.getElementById("back-to-main-from-shop-button");

        var playerHealthSpan = document.getElementById("player-health");
        var playerHealthBar = document.getElementById("player-health-bar");
        var enemyHealthSpan = document.getElementById("enemy-health");
        var enemyHealthBar = document.getElementById("enemy-health-bar");

        var mainMenu = document.getElementById("main-menu");
        var hud = document.getElementById("hud");
        var shop = document.getElementById("shop");
        var inventory = document.getElementById("inventory");
        
          
        var customizationScreen = document.getElementById("customization-screen");
        var backToMainMenu = document.getElementById("backToMainMenu");
        var weapon_lv1 = document.getElementById("weapon_lv1");
        var weapon_lv2 = document.getElementById("weapon_lv2");
        var weapon_lv3 = document.getElementById("weapon_lv3");
        var weapon_confirm = document.getElementById("weapon_confirm");
          
        var armor_lv1 = document.getElementById("armor_lv1");
        var armor_lv2 = document.getElementById("armor_lv2");
        var armor_lv3 = document.getElementById("armor_lv3");
        var armor_confirm = document.getElementById("armor_confirm");
          
          var shop_armor = document.getElementById("shop-armor");
          
          

        var player_health = 100;
        //default
        var armor_type = 200;
        var weapon_type = 0;
        var weapon_level = 0;
        var armor_level = 0;
        var enemy_health = 3000;

        var bridge = {
          queue: [],
          enqueue: function(function_pointer, string_argument) {
            this.queue.push(function_pointer + "|" + string_argument);
          },
          dequeue: function() {
            dequeued_message = this.queue.shift();
            return dequeued_message;
          },
          register: function(function_name, function_pointer) {
            this[function_name] = function(string_argument) {
              this.enqueue(function_pointer, string_argument);
            };
          },
          finalize: function() {
            show_inventory();
            show_main_menu();
            return true;
          }
        };
        
        var debug_alert = function() {
          bridge.echoecho("foo");
        };

        var present_results = function() {
          document.body.className = "translucent";
          hud.className = "invisible";
          mainMenu.className = "visible";
          bridge.set_user_interaction_enabled("1");
            

        };

        var hide_body = function() {
          document.body.className = "transparent";
        };

        var show_body = function() {
          document.body.className = "translucent";
        };

        var hide_main_menu = function() {
          mainMenu.className = "invisible";
        };

        var show_main_menu = function() {
          mainMenu.className = "visible";
        };

        var hide_hud = function() {
          hud.className = "invisible";
        };

        var show_hud = function() {
          hud.className = "visible transparent";
        };

        var hide_shop = function() {
          shop.className = "invisible";
        };

        var show_shop = function() {
          shop.className = "visible transparent";
          shop_armor.innerHTML = "current level " + armor_level;
        };
          
          
        var hide_customizationScreen=function(){
            customizationScreen.className = "invisible";
        }
          
        var show_customizationScreen=function(){
            customizationScreen.className = "visible";
        }
          
        var hide_inventory = function() {
          inventory.className = "invisible";
        };

        var show_inventory = function() {
          inventory.className = "visible transparent";
        };

        startButton.onclick = function(e) {        
            hide_main_menu();
            hide_inventory();
            show_customizationScreen();
        };

        shopButton.onclick = function(e) {
          hide_main_menu();
          show_shop();
        };
          
        Fight.onclick = function(e){
          try {
              hide_body();
              hide_main_menu();
              hide_inventory();
              hide_customizationScreen();
              show_hud();
              bridge.set_user_interaction_enabled("0");
              
              bridge.start_game("1," + weapon_type +","+armor_type);
          } catch(e) {
              alert(e);
          }
        }
          
        
         weapon_lv1.onclick = function(e){
            weapon_type =  this.getAttribute("level");
         }
          
          weapon_lv2.onclick = function(e){
              weapon_type =  this.getAttribute("level");
          }
          
          weapon_lv3.onclick = function(e){
              weapon_type =  this.getAttribute("level");
          }
          
          
          armor_lv1.onclick = function(e){
              armor_type =  this.getAttribute("level");
          }
          
          armor_lv2.onclick = function(e){
              armor_type =  this.getAttribute("level");
          }
          
          armor_lv3.onclick = function(e){
              warmor_type =  this.getAttribute("level");
          }
           
        backToMainFromShopButton.onclick = function(e) {
          hide_shop();
          show_main_menu();
        };
          
          backToMainMenu.onclick = function(e){
              hide_customizationScreen();
              show_main_menu();
          };


        (function tick() {
          try {
            var player_health_percent = (player_health / 100.0) * 100.0;
            var enemy_health_percent = (enemy_health / 3000.0) * 100.0;
            playerHealthBar.style.webkitTransform = "translate3d(-" + (100.0 - player_health_percent) + "%, 0, 0)";
            enemyHealthBar.style.webkitTransform = "translate3d(-" + (100.0 - enemy_health_percent) + "%, 0, 0)";
            //playerHealthSpan.innerHTML = player_health;
            //enemyHealthSpan.innerHTML = enemy_health;
            setTimeout(tick, 0); //32ms is 30fps
          } catch(e) {
            alert(e);
          }
        })();
      } catch(e) {
        alert(e);
      }
    </script>
  </body>
</html>
